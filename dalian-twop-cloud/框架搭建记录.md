基于阿里巴巴springcloud的微服务框架搭建，版本号为springboot(2.6.13), spring-cloud为(2021.0.5)、alibaba为（2021.0.5.0）

# 一、创建项目

## 1、创建

idea创建spring-boot项目，首先创建一个父maven项目，空项目。

## 2、修改

项目创建好后，将src等文件夹删除。修改POM文件，在配置文件中，

a. 增加packaging标签，标识这是个父POM文件。

```xml
<packaging>POM</packaging>
```

b.引入spring-boot的依赖

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-dependencies</artifactId>
    <version>${spring-boot.version}</version>
    <type>pom</type>
    <scope>import</scope>
</dependency>
```

c.引入spring-cloud的依赖

```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-dependencies</artifactId>
    <version>${spring-cloud.version}</version>
    <scope>import</scope>
    <type>pom</type>
</dependency>
```

d.引入spring-cloud-alibaba的依赖

````xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-dependencies</artifactId>
    <version>${spring-cloud.version}</version>
    <scope>import</scope>
    <type>pom</type>
</dependency>
````

e.管理各个版本

```xml
<java.version>1.8</java.version>
<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
<project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
<spring-boot.version>2.6.13</spring-boot.version>
<spring-cloud.version>2021.0.5</spring-cloud.version>
<spring-cloud-alibaba.version>2021.0.5.0</spring-cloud-alibaba.version>
<lombok.version>1.18.22</lombok.version>
```

对于版本管理来说，在github上搜索alibaba/alibaba-spring-cloud中参照，wiki上的版本对照表。

## 3、添加子模块

新建Module，然后修改pom文件，将子模块的pom文件内容底部全部删除，加入parent标签，将父pom的的groupId、artifactId引入进来

```xml
<parent>
    <groupId>com.daliantwop.cloud</groupId>
    <artifactId>dalian-twop-cloud</artifactId>
    <version>0.0.1-SNAPSHOT</version>
</parent>
```

修改父Pom文件，添加module标签，将子模块引入进来

```xml
<modules>
    <module>dalian-twop-user</module>
    <module>dalian-twop-store</module>
    <module>dalian-twop-order</module>
    <module>dalian-twop-member</module>
    <module>dalian-twop-finance</module>
    <module>dalian-twop-customer-service</module>
    <module>dalian-twop-report</module>
    <module>dalian-twop-message</module>
    <module>dalian-twop-system</module>
</modules>
```

## 4、添加Nacos依赖

```xml
<!-- 引入nacos discovery 的依赖 -->
<dependency>
    <groupId>com.alibaba.cloud</groupId>
    <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
</dependency>

<!-- 引入nacos config 注册中心的依赖 -->
<dependency>
    <groupId>com.alibaba.cloud</groupId>
    <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
</dependency>
```

## 5、注意事项

子模块注入到nacos服务中心时遇到了一个问题，当程序写好后，启动时，报错，报错内容如下

```java
Application failed to connect to Nacos server: "null"
```

问题原因：spring-cloud在2020版本以后，移除了spring-cloud-starter-bootstrap的依赖，需要显示的引入此依赖，注意，版本号不能太高。3.0.3刚好。

```xml
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-bootstrap</artifactId>
    <version>3.0.3</version>
</dependency>
```

问题解决。
